# ADR-008: 多模態互動設計決策

---

**狀態 (Status):** `已接受 (Accepted)`

**決策者 (Deciders):** `PM, Technical Lead, UX Designer`

**日期 (Date):** `2025-10-17`

**技術顧問 (Consulted - 選填):** `Frontend DEV, Backend DEV`

**受影響團隊 (Informed - 選填):** `All Development Team`

---

## 1. 背景與問題陳述 (Context and Problem Statement)

*   **上下文 (Context):** AI Audio Chat Visualizer 最初設計為**純語音互動**應用 (參考 ADR-002),專注於 3D 音訊視覺化。然而,在 Phase 2 架構設計與 ADR-006 (Realtime API) 決策後,技術棧已具備**原生多模態能力** (語音 + 圖片 + 文字),且 OpenAI Realtime API 支援同時處理多種輸入模態。PM 與 UX Designer 在需求審查中發現,**單一模態互動限制了使用場景**,無法滿足用戶的實際需求。

*   **問題陳述 (Problem Statement):** 原始設計的**純語音互動**存在以下限制:

    1.  **無法處理視覺相關問題**:
        *   用戶無法上傳圖片詢問 "這是什麼?"
        *   無法進行程式碼截圖除錯
        *   無法進行商品/植物/動物識別
        *   預估損失 **30%** 潛在使用場景

    2.  **無備援輸入方式**:
        *   麥克風權限被拒絕時,用戶無法使用
        *   嘈雜環境下語音辨識失敗,無替代方案
        *   導致 **15-20%** 用戶流失

    3.  **複雜描述困難**:
        *   無法用 "語音 + 圖片" 組合表達複雜問題
        *   例如: [截圖] + "這段程式碼的第 5 行有什麼問題?"
        *   用戶體驗受限

    4.  **技術能力未充分利用**:
        *   Realtime API 已支援多模態,但未使用
        *   浪費技術優勢與競爭力

*   **驅動因素/約束條件 (Drivers / Constraints):**
    *   **驅動因素 1**: PM 要求支援圖片上傳與視覺問答 (擴展使用場景)
    *   **驅動因素 2**: Realtime API 原生支援多模態 (技術已就緒)
    *   **驅動因素 3**: 競品分析顯示多模態是行業趨勢 (競爭需求)
    *   **約束條件 1**: MVP 時程不變 (2-3 週),UI 改動需最小化
    *   **約束條件 2**: 保留 3D 視覺化為核心特色 (不能搶焦點)
    *   **約束條件 3**: 延遲仍需 < 3 秒 (圖片處理不能拖慢體驗)

## 2. 考量的選項 (Considered Options)

### 選項一: 維持純語音互動 (不做改動)

*   **描述:** 保持原始設計,僅支援語音輸入/輸出,不增加圖片或文字支援。
*   **優點 (Pros):**
    *   ✅ 無額外開發成本
    *   ✅ UI 保持極簡
    *   ✅ 聚焦核心 3D 視覺化
*   **缺點 (Cons):**
    *   ❌ 無法處理視覺問題 (損失 30% 場景)
    *   ❌ 無備援輸入方式 (15-20% 用戶流失)
    *   ❌ 浪費 Realtime API 多模態能力
    *   ❌ 競爭力不足 (競品多已支援)
*   **成本/複雜度評估:** 開發成本: 低 | 維護成本: 低 | **用戶價值: 低**

---

### 選項二: 僅增加文字輸入 (備援模式)

*   **描述:** 增加文字輸入框作為語音失敗時的備援,但不支援圖片上傳。
*   **優點 (Pros):**
    *   ✅ 解決麥克風權限問題
    *   ✅ 開發成本低 (~4-6 小時)
    *   ✅ UI 改動最小
*   **缺點 (Cons):**
    *   ❌ 仍無法處理視覺問題 (損失 30% 場景)
    *   ❌ 未充分利用 Realtime API 能力
    *   ❌ 競爭力提升有限
*   **成本/複雜度評估:** 開發成本: 低 | 用戶價值: 中 | **不足以滿足核心需求**

---

### 選項三: 完整多模態互動 (語音 + 圖片 + 文字) ✅

*   **描述:** 實作**真正的多模態互動介面**,支援:
    *   語音輸入 (主要模式)
    *   圖片上傳與視覺問答
    *   文字輸入 (備援模式)
    *   語音 + 圖片組合輸入

*   **優點 (Pros):**
    *   ✅ **解決所有核心痛點** (視覺問題、備援、組合輸入)
    *   ✅ **充分利用 Realtime API** 多模態能力
    *   ✅ **擴展使用場景 +30%** (圖片識別、程式碼除錯、商品查詢)
    *   ✅ **降低用戶流失 15-20%** (文字備援)
    *   ✅ **競爭優勢** - 少數支援真正多模態語音互動的產品
    *   ✅ **未來擴展性** - 可輕易加入視訊等模態

*   **缺點 (Cons):**
    *   ❌ **開發成本增加** (~12-16 小時)
    *   ❌ **UI 複雜度提升** (需平衡極簡與功能)
    *   ❌ **圖片處理延遲** (需優化壓縮策略)
    *   ❌ **測試成本增加** (多種輸入組合)

*   **成本/複雜度評估:**
    *   開發成本: 中 (~12-16 小時)
    *   維護成本: 中
    *   用戶價值: **極高**
    *   ROI: **優秀** (投入 16 小時,獲得 30% 場景擴展 + 15-20% 流失降低)

---

### 選項四: 圖片 + 文字 (純文字模態,無語音)

*   **描述:** 移除語音功能,改為純文字聊天 + 圖片上傳 (類似 ChatGPT)。
*   **優點 (Pros):**
    *   ✅ 開發簡單
    *   ✅ 無麥克風權限問題
*   **缺點 (Cons):**
    *   ❌ **違背專案核心定位** (AI Audio Chat)
    *   ❌ 喪失 3D 音訊視覺化意義
    *   ❌ 與 ChatGPT 等產品無差異化
*   **成本/複雜度評估:** **不符合專案定位,直接排除**

---

## 3. 決策 (Decision Outcome)

**最終選擇的方案:** `選項三: 完整多模態互動 (語音 + 圖片 + 文字)`

**選擇理由 (Rationale):**

*   **核心理由 1 - 解決所有痛點:** 選項三同時解決**視覺問題**、**備援輸入**、**組合輸入**三大核心痛點,而選項一/二僅解決部分問題。這是唯一能滿足所有需求的方案。

*   **核心理由 2 - ROI 最佳:** 雖然開發成本增加 12-16 小時,但獲得:
    *   **+30% 使用場景擴展** (圖片識別、程式碼除錯、商品查詢)
    *   **-15-20% 用戶流失** (文字備援)
    *   **競爭差異化** (少數支援真正多模態語音互動的產品)
    *   投資報酬率遠超其他選項

*   **核心理由 3 - 技術就緒:** Realtime API 已原生支援多模態,無需額外 API 整合或複雜架構設計,主要工作是前端 UI 與圖片壓縮,技術風險低。

*   **核心理由 4 - 符合行業趨勢:** 競品分析 (Hume AI EVI, ElevenLabs, Google Astra) 顯示多模態是行業標準,不跟進將失去競爭力。

*   **與其他選項的權衡比較 (Trade-off Analysis):**
    *   **vs 選項一 (維持純語音)**: 選項一成本最低但價值也最低,損失 30% 場景且 15-20% 用戶流失,長期不可持續
    *   **vs 選項二 (僅文字)**: 選項二僅解決備援問題 (-15-20% 流失),但仍損失 30% 視覺場景,投入 4-6 小時收益有限
    *   **vs 選項三 (多模態)**: 投入 12-16 小時,獲得完整解決方案且未來可持續擴展,是最佳長期投資

*   **與長期架構目標的一致性:** 本決策與 ADR-006 (Realtime API) 一致,充分利用其多模態能力,且為未來加入視訊、文件等模態預留擴展性,符合「可擴展架構」的設計原則。

---

## 4. 決策的後果與影響 (Consequences)

*   **正面影響 / 預期收益:**
    *   ✅ **使用場景擴展 +30%**: 支援圖片識別、程式碼除錯、商品查詢等新場景
    *   ✅ **用戶流失降低 15-20%**: 文字備援確保麥克風問題不影響使用
    *   ✅ **競爭差異化**: 少數支援語音 + 圖片組合輸入的產品
    *   ✅ **用戶滿意度提升**: 預估從 3.5/5 提升至 4.2/5 (更靈活的互動方式)
    *   ✅ **未來擴展性**: 架構可輕易加入視訊、文件等模態

*   **負面影響 / 引入的風險:**
    *   ❌ **UI 複雜度增加**: 需平衡極簡與功能,過多按鈕可能干擾 3D 視覺化
        *   **緩解**: 使用圖標取代文字、支援鍵盤快捷鍵、隱藏非必要按鈕
    *   ❌ **圖片處理延遲**: 大圖片壓縮可能增加 500ms-1s 延遲
        *   **緩解**: 前端壓縮、限制圖片大小 (< 5MB)、顯示 loading 狀態
    *   ❌ **測試成本增加**: 需測試 9 種輸入組合 (語音、圖片、文字、語音+圖片等)
        *   **緩解**: 優先測試核心組合 (語音、圖片、語音+圖片)
    *   ❌ **開發時程增加 12-16 小時**:
        *   **緩解**: 可接受,仍在 MVP 2-3 週範圍內

*   **對其他組件/團隊的影響:**
    *   **Frontend Team**: 需開發圖片上傳組件、多模態輸入控制器、聊天介面 (~12 小時)
    *   **Backend Team**: Realtime API 已支援,僅需處理圖片 base64 編碼 (~2 小時)
    *   **UX Team**: 需設計圖標、互動流程、響應式布局 (~4 小時)
    *   **QA Team**: 需新增多模態測試場景 (~6 小時)

*   **未來可能需要重新評估的觸發條件:**
    *   UI 複雜度導致 3D 視覺化失去焦點 (用戶反饋)
    *   圖片處理延遲 > 2 秒 (影響體驗)
    *   多模態使用率 < 10% (功能未被充分使用)

---

## 5. (選填) 執行計畫概要 (Implementation Plan Outline)

### Phase 1: 基礎圖片支援 (Week 2, Day 4)
1.  圖片上傳組件 (前端)
2.  圖片壓縮工具 (前端)
3.  圖片預覽 UI (前端)
**預估時間**: 4 小時

### Phase 2: Realtime API 整合 (Week 2, Day 5)
1.  多模態訊息格式調整 (前端)
2.  WebSocket 圖片傳輸 (前端)
3.  視覺分析回應處理 (前端)
**預估時間**: 4 小時

### Phase 3: UI/UX 優化 (Week 3, Day 1)
1.  聊天介面顯示圖片
2.  模態切換指示
3.  響應式布局調整
**預估時間**: 4 小時

**總計**: ~12 小時

---

## 6. (選填) 相關參考 (References)

- [OpenAI Vision API](https://platform.openai.com/docs/guides/vision)
- [GPT-4o Multimodal Capabilities](https://openai.com/index/hello-gpt-4o/)
- [Image Compression in Browser](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Using_images)
- [File API](https://developer.mozilla.org/en-US/docs/Web/API/File_API)

---

**ADR 審核記錄 (Review History):**

| 日期       | 審核人     | 角色       | 備註/主要問題 |
| :--------- | :--------- | :--------- | :------------ |
| 2025-10-17 | PM | 產品經理 | ✅ 同意採用,要求 UI 保持簡潔 |
| 2025-10-17 | Technical Lead | 技術負責人 | ✅ 同意,需優化圖片壓縮 |
| 2025-10-17 | UX Designer | 設計師 | ✅ 同意,需平衡功能與極簡設計 |

---

**文檔版本**: v2.0
**最後更新**: 2025-10-17
**下次審查**: 2025-10-24 (Phase 3 完成後)

**相關 ADR:**
- ADR-006: Realtime API Integration (本 ADR 依賴)
- ADR-007: MCP Tools Integration (相關)

**END OF ADR**
